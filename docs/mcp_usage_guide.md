# 豆瓣电影MCP使用指南

本文档提供了豆瓣电影MCP (Model Control Panel) 的详细使用指南，帮助大型语言模型有效地集成和使用此MCP来增强电影推荐和信息检索能力。

## 什么是豆瓣电影MCP？

豆瓣电影MCP是一个专为大型语言模型设计的服务，它提供了与豆瓣电影数据相关的API，使模型能够：

1. 获取电影详细信息
2. 搜索电影
3. 根据用户偏好获取电影推荐

这些功能使模型能够为用户提供更准确、更全面的电影信息和推荐。

## API端点和调用指南

### 1. 获取电影详情

**端点**: `GET /api/movie/:id`

**用途**: 根据电影ID获取详细信息

**调用示例**:

```
当用户询问特定电影的详细信息时，可以使用此端点获取。

例如，用户询问："能告诉我《星际穿越》这部电影的详细信息吗？"

1. 先使用搜索端点获取电影ID
2. 再使用此端点获取详细信息
3. 然后整理信息呈现给用户
```

**参数说明**:
- `id`: 电影ID (路径参数)

**响应处理建议**:
- 使用返回的`summary`字段获取电影简介
- 使用`directors`和`casts`字段获取导演和主演信息
- 使用`rating.average`获取评分

### 2. 搜索电影

**端点**: `GET /api/search?q=关键词&start=0&count=20`

**用途**: 根据关键词搜索电影

**调用示例**:

```
当用户询问关于某部电影或某类电影时，可以使用此端点进行搜索。

例如，用户询问："有哪些克里斯托弗·诺兰导演的电影？"

1. 使用搜索端点，关键词为"克里斯托弗·诺兰"
2. 处理搜索结果，提取电影列表
3. 整理信息呈现给用户
```

**参数说明**:
- `q`: 搜索关键词 (必填)
- `start`: 分页起始位置 (可选，默认0)
- `count`: 每页结果数量 (可选，默认20)

**响应处理建议**:
- 检查`total`字段了解总共有多少结果
- 如果结果太多，可以提示用户缩小搜索范围
- 提取前几个最相关的结果呈现给用户

### 3. 电影推荐

**端点**: `POST /api/recommend`

**用途**: 根据用户偏好获取电影推荐

**调用示例**:

```
当用户询问电影推荐时，可以使用此端点。

例如，用户询问："推荐几部2020年后的高分科幻电影"

1. 解析用户偏好：类型(科幻)、年份(2020年后)、评分(高分)
2. 构造请求参数：genres=["科幻"], year_range="2020-2023", rating_range="8-10"
3. 调用推荐端点获取结果
4. 整理推荐结果呈现给用户
```

**请求参数**:
- `genres`: 电影类型数组 (可选)
- `tags`: 标签数组 (可选)
- `year_range`: 年份范围，格式为"起始年份-结束年份" (可选)
- `rating_range`: 评分范围，格式为"最低分-最高分" (可选)
- `limit`: 返回结果数量限制 (可选，默认10)

**响应处理建议**:
- 提取电影标题、评分、年份等信息组织成易读的推荐列表
- 可以添加额外的电影简介或其他特点来丰富推荐内容

## 最佳实践

### 1. 参数解析

从用户对话中提取关键信息作为API参数：

- **电影类型**: 从用户描述中提取类型关键词（如"科幻"、"动作"、"喜剧"等）
- **时间范围**: 识别用户提及的年代或时间段（如"90年代"、"近五年"、"2010年以后"等）
- **评分要求**: 识别用户对电影质量的要求（如"高分"、"评分8分以上"、"豆瓣9分"等）

### 2. 结果处理

- 将API返回的结果转化为清晰、简洁的自然语言回复
- 对于电影列表，使用编号或项目符号呈现
- 为每部电影添加关键信息：标题、年份、评分、主演等
- 考虑根据用户的初始问题提供额外的上下文或解释

### 3. 错误处理

- 当API返回错误时，提供友好的错误消息
- 对于无结果的查询，提供替代建议或询问用户是否愿意放宽搜索条件
- 处理不明确的用户需求，可以主动询问用户来澄清意图

## 集成示例

### 例1: 搜索电影并提供信息

```
用户: "你知道《星际穿越》这部电影吗？"

系统处理:
1. 解析出关键词"星际穿越"
2. 调用搜索API: GET /api/search?q=星际穿越
3. 从结果中找到最匹配的电影
4. 获取该电影详情: GET /api/movie/[id]
5. 整理信息返回给用户

系统回复: "《星际穿越》是2014年克里斯托弗·诺兰导演的科幻电影，豆瓣评分9.3。由马修·麦康纳、安妮·海瑟薇主演。影片讲述了一组宇航员通过虫洞进入其他维度寻找人类未来家园的故事。该片获得了多项奥斯卡奖项，包括最佳视觉效果奖。"
```

### 例2: 提供电影推荐

```
用户: "推荐几部好看的悬疑片"

系统处理:
1. 解析出类型"悬疑"和质量要求"好看"
2. 构造推荐参数: { genres: ["悬疑"], rating_range: "8-10", limit: 5 }
3. 调用推荐API: POST /api/recommend
4. 整理推荐结果

系统回复: "以下是几部高分悬疑电影推荐：
1. 《调音师》(8.3分) - 2018年
2. 《无间道》(9.2分) - 2002年
3. 《搏击俱乐部》(9.0分) - 1999年
4. 《致命ID》(8.8分) - 2003年
5. 《记忆碎片》(8.6分) - 2000年"
```

## 常见问题解答

**Q: 如何处理模糊的用户查询？**

A: 对于模糊查询，可以先尝试使用搜索API获取相关结果，然后根据返回结果向用户提供澄清选项。例如，当用户问"有什么好看的电影"时，可以主动询问用户的类型偏好或时间范围偏好。

**Q: 如何处理非常具体的电影查询？**

A: 对于具体查询，如"2019年的获得奥斯卡最佳影片的电影是什么"，可以组合使用年份范围和搜索关键词（如"奥斯卡最佳影片"）来缩小结果范围。

**Q: 推荐API中的类型参数使用什么值？**

A: 电影类型参数可以使用常见的电影类型，如"剧情"、"科幻"、"动作"、"喜剧"、"恐怖"、"悬疑"、"动画"等。 